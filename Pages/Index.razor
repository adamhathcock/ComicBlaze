@page "/"
@inherits BaseComponent

@using Tewr.Blazor.FileReader

@inject IFileReaderService FileReaderService;


<Modal @ref="_loadingModal" ShowBackdrop="true">
    <ModalContent IsCentered="true">
        <ModalBody>
            Loading @_pageInfo ...
        </ModalBody>
    </ModalContent>
</Modal>    
<Modal @ref="_pagesModal" ShowBackdrop="true">
    <ModalContent IsCentered="true">     
        <ModalHeader>
            <ModalTitle>Pages</ModalTitle>
            <CloseButton />       
        </ModalHeader>
        <ModalBody>     
            @if (_reader != null)
            {
                <PageList Pages="_reader.GetFiles()"/>
            }
        </ModalBody>
    </ModalContent>
</Modal>
<input type="file" @ref="_inputTypeFileElement" @oninput=ReadFile/> 
@if (_reader != null)
{
    <Button Clicked="@OnButtonClicked">Pages List</Button>
}


@if (_reader != null)
 {
    <Carousel @ref="_carousel" Autoplay="false" SelectedSlideChanged="SelectedSlideChanged">  

            @foreach(var pageInfo in _reader.GetPageInfos().Select(x => new [] {x}))
            {
                <CarouselSlide Name="@pageInfo[0]">    
                    <Virtualize Context="x" Items="@pageInfo">
                        <ComicPage Page=@x ComicReader="_reader" />
                    </Virtualize>
                </CarouselSlide>
            }
    </Carousel>
}
